<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="/static/css/logo.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Members to be Covered</title>
    <link rel="stylesheet" href="../css/members.css">
    <link rel="stylesheet" href="../css/health_history.css">
    <link rel="stylesheet" href="../css/common.css">
    <style>
        /* Tab Navigation Styles */
        .member-tabs-container {
            margin-bottom: 0;
            background-color: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .member-tabs {
            display: flex;
            gap: 0;
            overflow-x: auto;
            flex-wrap: nowrap;
            padding: 0.5rem 1rem 0 1rem;
            background-color: transparent;
        }

        .member-tab {
            padding: 0.75rem 1.5rem;
            background-color: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            position: relative;
            color: #6c757d;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .member-tab:hover {
            color: #495057;
            background-color: rgba(0, 123, 255, 0.05);
        }

        .member-tab.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background-color: white;
        }

        .member-tab.add-new-tab {
            color: #007bff;
            background-color: transparent;
            border: none;
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
        }

        .member-tab.add-new-tab:hover {
            background-color: rgba(0, 123, 255, 0.08);
        }

        .member-tab.add-new-tab.active {
            background-color: white;
            border-bottom-color: #007bff;
        }

        .member-tab.modified::after {
            content: "";
            position: absolute;
            top: 8px;
            right: 8px;
            width: 6px;
            height: 6px;
            background-color: #007bff;
            border-radius: 50%;
        }

        /* Tab Content Styles */
        .member-tab-content {
            display: none;
            padding: 2rem;
            background-color: white;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 8px 8px;
            min-height: 400px;
        }

        .member-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .member-tab-content h3 {
            color: #343a40;
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #e9ecef;
        }

        .form-actions-inline {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #dee2e6;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
            margin-left: auto;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        /* Scrollbar styling for tab overflow */
        .member-tabs::-webkit-scrollbar {
            height: 4px;
        }

        .member-tabs::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .member-tabs::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .member-tabs::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Dropdown styles */
        .searchable-dropdown-wrapper {
            position: relative;
        }

        .dropdown-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid #ced4da;
            border-top: none;
            list-style: none;
            margin: 0;
            padding: 0;
            z-index: 1000;
            display: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .dropdown-list.show {
            display: block;
        }

        .dropdown-list li {
            padding: 0.5rem 0.75rem;
            cursor: pointer;
            transition: background-color 0.15s ease;
        }

        .dropdown-list li:hover,
        .dropdown-list li.highlighted {
            background-color: #f8f9fa;
        }

        .dropdown-list li.other-option {
            font-weight: 600;
            border-bottom: 1px solid #dee2e6;
            background-color: #f8f9fa;
        }

        /* screen size adjustments */
        @media (max-width: 768px) {
            .member-tabs {
                padding: 0.25rem 0.5rem 0 0.5rem;
            }

            .member-tab {
                padding: 0.6rem 1rem;
                font-size: 0.875rem;
            }

            .member-tab-content {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <fieldset>
        <!-- Member Tabs Container -->
        <div class="member-tabs-container">
            <div class="member-tabs" id="member-tabs">
                <!-- Tabs will be dynamically added here -->
            </div>
        </div>

        <!-- Tab Contents Container -->
        <div id="member-tab-contents">
            <!-- Tab content panels will be dynamically added here -->
        </div>
    </fieldset>

    <!-- Template for Member Form -->
    <template id="member-form-template">
        <div class="member-tab-content">
            <h3 style="margin-top: 0;">Member Details</h3>
            <div class="member-form">
                <fieldset>
                    <legend>Personal & Professional</legend>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" class="member-name" name="member_name" required pattern="[A-Za-z][A-Za-z.'\s]*" title="Name must start with a letter and can only contain letters, spaces, and apostrophes.">
                            <span class="error-message member-name-error"></span>
                        </div>
                        <div class="form-group">
                            <label>Relationship *</label>
                            <select class="relationship" name="relationship" required>
                                <option value="">Select Relationship</option>
                                <option value="spouse">Spouse</option>
                                <option value="son">Son</option>
                                <option value="daughter">Daughter</option>
                                <option value="father">Father</option>
                                <option value="mother">Mother</option>
                                <option value="father-in-law">Father-in-law</option>
                                <option value="mother-in-law">Mother-in-law</option>
                            </select>
                            <span class="error-message relationship-error"></span>
                        </div>
                        <div class="form-group">
                            <label>Gender *</label>
                            <select class="member-gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                            <span class="error-message member-gender-error"></span>
                        </div>
                    </div>

                    <div class="form-row" style="display: flex; flex-wrap: nowrap;">
                        <div class="form-group" style="flex: 1;">
                            <label>Primary Occupation</label>
                            <div class="searchable-dropdown-wrapper">
                                <input type="text" 
                                    class="member-occupation" 
                                    name="occupation" 
                                    placeholder="Search or select primary occupation..."
                                    autocomplete="off"
                                    pattern="[A-Za-z\s]+" 
                                    title="Please enter only letters and spaces.">
                                <input type="hidden" class="member-occupation-value" name="occupation_value">
                                <ul class="member-occupation-list dropdown-list" role="listbox"></ul>
                            </div>
                            <span class="error-message member-occupation-error"></span>
                        </div>
                        <div class="form-group" style="flex: 1;">
                            <div class="form-group-checkbox" style="display: flex; align-items: center; gap: 5px; height: 21px; margin-bottom: 2px;">
                                <input type="checkbox" class="member-secondary-occupation-checkbox" name="member_secondary_occupation_checkbox">
                                <label class="member-secondary-occupation-label">Secondary Occupation</label>
                            </div>
                            <div class="member-secondary-occupation-section" style="display: none;">
                                <div class="searchable-dropdown-wrapper">
                                    <input type="text" 
                                        class="member-secondary-occupation" 
                                        name="member_secondary_occupation" 
                                        placeholder="Search or select secondary occupation..."
                                        autocomplete="off"
                                        pattern="[A-Za-z\s]+" 
                                        title="Please enter only letters and spaces.">
                                    <input type="hidden" class="member-secondary-occupation-value" name="member_secondary_occupation_value">
                                    <ul class="member-secondary-occupation-list dropdown-list" role="listbox"></ul>
                                </div>
                                <span class="error-message member-secondary-occupation-error"></span>
                            </div>
                        </div>
                    </div>
                </fieldset>
                
                <!-- Health Vitals -->
                <fieldset>
                    <legend>Health Vitals</legend>
                    <div class="form-row compact-row">
                        <div class="form-group">
                            <label>Date of Birth *</label>
                            <input type="date" class="member-dob" name="member-dob" required>
                            <span class="error-message member-dob-error"></span>
                        </div>
                        <div class="form-group fixed-width-group">
                            <label>Height *</label>
                            <!-- Visible feet/inches dropdowns -->
                            <div class="height-input-wrapper" style="display:flex; align-items:center; gap:4px;">
                                <select
                                    class="member-height-ft"
                                    name="member-height-ft"
                                    required
                                    title="Please select feet."
                                    style="width: 4.5em;"
                                >
                                    <option value="">ft</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                </select>
                                <span>ft</span>

                                <select
                                    class="member-height-in"
                                    name="member-height-in"
                                    required
                                    title="Please select inches."
                                    style="width: 4.5em;"
                                >
                                    <option value="">in</option>
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                </select>
                                <span>in</span>
                            </div>
                            <input type="hidden" class="member-height" name="member-height">
                            <span class="error-message member-height-ft-error"></span>
                            <span class="error-message member-height-in-error"></span>
                        </div>

                        <div class="form-group fixed-width-group">
                            <label>Weight (kg) *</label>
                            <input type="number" class="member-weight" name="member-weight" placeholder="e.g., 70" min="1" step="0.1" title="Please enter weight in kg (minimum 1 kg)." required>
                            <span class="error-message member-weight-error"></span>
                        </div>
                        <div class="form-group fixed-width-group">
                            <label>Age</label>
                            <input type="text" class="member-age" name="member-age" readonly class="readonly-field">
                        </div>
                        <div class="form-group fixed-width-group">
                            <label>BMI</label>
                            <input type="text" class="member-bmi" name="member-bmi" readonly class="readonly-field">
                        </div>
                    </div>
                </fieldset>
                
                <!-- Health History Section -->
                <fieldset>
                    <legend>Medical History & Lifestyle</legend>
                    <fieldset class="sub-fieldset">
                        <legend>Disease Details</legend>
                        <div class="group-box member-disease-list-group">
                            <div class="member-disease-list">
                                <!-- Cardiac Problems -->
                                <div class="disease-entry">
                                    <div class="disease-header">
                                        <label class="checkbox-container">
                                            <input type="checkbox" name="disease" value="cardiac">
                                            Cardiac Problems
                                        </label>
                                    </div>
                                    <div class="disease-details-container">
                                        <div class="disease-date-group">
                                            <label>Disease Start Date *</label>
                                            <input type="date" name="cardiac_start_date" class="disease-date-input member-disease-date" disabled>
                                            <span class="error-message cardiac-start-date-error"></span>
                                        </div>
                                        <textarea name="cardiac_details" class="disease-details-textarea" placeholder="Provide more details..." rows="2" disabled></textarea>
                                    </div>
                                </div>

                                <!-- Diabetes -->
                                <div class="disease-entry">
                                    <div class="disease-header">
                                        <label class="checkbox-container">
                                            <input type="checkbox" name="disease" value="diabetes">
                                            Diabetes
                                        </label>
                                    </div>
                                    <div class="disease-details-container">
                                        <div class="disease-date-group">
                                            <label>Disease Start Date *</label>
                                            <input type="date" name="diabetes_start_date" class="disease-date-input member-disease-date" disabled>
                                            <span class="error-message diabetes-start-date-error"></span>
                                        </div>
                                        <textarea name="diabetes_details" class="disease-details-textarea" placeholder="Provide more details..." rows="2" disabled></textarea>
                                    </div>
                                </div>

                                <!-- Hypertension -->
                                <div class="disease-entry">
                                    <div class="disease-header">
                                        <label class="checkbox-container">
                                            <input type="checkbox" name="disease" value="hypertension">
                                            Hypertension
                                        </label>
                                    </div>
                                    <div class="disease-details-container">
                                        <div class="disease-date-group">
                                            <label>Disease Start Date *</label>
                                            <input type="date" name="hypertension_start_date" class="disease-date-input member-disease-date" disabled>
                                            <span class="error-message hypertension-start-date-error"></span>
                                        </div>
                                        <textarea name="hypertension_details" class="disease-details-textarea" placeholder="Provide more details..." rows="2" disabled></textarea>
                                    </div>
                                </div>

                                <!-- Cancer -->
                                <div class="disease-entry">
                                    <div class="disease-header">
                                        <label class="checkbox-container">
                                            <input type="checkbox" name="disease" value="cancer">
                                            Cancer
                                        </label>
                                    </div>
                                    <div class="disease-details-container">
                                        <div class="disease-date-group">
                                            <label>Disease Start Date *</label>
                                            <input type="date" name="cancer_start_date" class="disease-date-input member-disease-date" disabled>
                                            <span class="error-message cancer-start-date-error"></span>
                                        </div>
                                        <textarea name="cancer_details" class="disease-details-textarea" placeholder="Provide more details..." rows="2" disabled></textarea>
                                    </div>
                                </div>

                                <!-- Critical Illnesses -->
                                <div class="disease-entry">
                                    <div class="disease-header">
                                        <label class="checkbox-container">
                                            <input type="checkbox" name="disease" value="critical_illness">
                                            Critical Illnesses
                                        </label>
                                    </div>
                                    <div class="disease-details-container">
                                        <div class="disease-date-group">
                                            <label>Disease Start Date *</label>
                                            <input type="date" name="critical_illness_start_date" class="disease-date-input member-disease-date" disabled>
                                            <span class="error-message critical-illness-start-date-error"></span>
                                        </div>
                                        <textarea name="critical_illness_details" class="disease-details-textarea" placeholder="Provide more details..." rows="2" disabled></textarea>
                                    </div>
                                </div>

                                <!-- Other -->
                                <div class="disease-entry">
                                    <div class="disease-header">
                                        <label class="checkbox-container">
                                            <input type="checkbox" name="disease" value="other">
                                            Other
                                        </label>
                                    </div>
                                    <div class="disease-details-container">
                                        <div class="disease-date-group">
                                            <label>Disease Start Date *</label>
                                            <input type="date" name="other_start_date" class="disease-date-input member-disease-date" disabled>
                                            <span class="error-message other-start-date-error"></span>
                                        </div>
                                        <textarea name="other_details" class="disease-details-textarea" placeholder="Please specify and provide details..." rows="2" disabled></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>

                    <div class="group-box">
                        <div class="form-row">
                            <div class="form-group span-2">
                                <label>Any Planned Surgeries/Hospitalization in the next 6-12 months?</label>
                                <textarea class="member-planned-surgeries" name="member-planned-surgeries" rows="2"></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="group-box">
                        <div class="group-title">Lifestyle Risk</div>
                        <div class="form-row">
                            <div class="form-group">
                                <fieldset>
                                    <legend>Smoker:</legend>
                                    <div class="radio-group">
                                        <label class="radio-label"><input type="radio" name="member-smoker" value="yes"> Yes</label>
                                        <label class="radio-label"><input type="radio" name="member-smoker" value="no" checked> No</label>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="form-group">
                                <fieldset>
                                    <legend>Alcohol Consumption:</legend>
                                    <div class="radio-group">
                                        <label class="radio-label"><input type="radio" name="member-alcohol" value="yes"> Yes</label>
                                        <label class="radio-label"><input type="radio" name="member-alcohol" value="no" checked> No</label>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="form-group">
                                <fieldset>
                                    <legend>Risky Hobbies (adventure sports, etc.)</legend>
                                    <div class="radio-group">
                                        <label class="radio-label"><input type="radio" name="member-risky-hobbies" value="yes"> Yes</label>
                                        <label class="radio-label"><input type="radio" name="member-risky-hobbies" value="no" checked> No</label>
                                    </div>
                                </fieldset>
                            </div>
                        </div>

                        <hr class="group-sep"/>

                        <div class="group-title">Occupational Risk</div>
                        <div class="form-row">
                            <div class="form-group">
                                <fieldset>
                                    <legend>Exposed to hazardous occupation?</legend>
                                    <div class="member-occupational-risk">
                                        <div class="radio-group">
                                            <label class="radio-label">
                                                <input type="radio" name="member-occupational-risk" value="yes"> Yes
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="member-occupational-risk" value="no" checked> No
                                            </label>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="form-group span-2 member-occupational-risk-details-group" style="display:none;">
                                <label>If yes, describe (e.g., mining, high-altitude, chemicals, heavy machinery)</label>
                                <textarea class="member-occupational-risk-details" name="occupational-risk-details" rows="2"></textarea>
                            </div>
                        </div>
                    </div>
                </fieldset>
                
                <!-- Form Actions -->
                <div class="form-actions-inline">
                    <div class="member-error error-message" style="display:none;color:red;margin-right:auto;"></div>
                    <button type="button" class="btn btn-primary save-member-btn">Save Member</button>
                    <button type="button" class="btn btn-secondary clear-member-btn">Clear Form</button>
                    <button type="button" class="btn btn-danger delete-member-btn" style="display:none;">Delete Member</button>
                </div>
            </div>
        </div>
    </template>
</body>
</html>